{% extends 'logged_navbar.html'%}
{% block content %}
<body>
<div class = "center-align">
        <div class="row">
                <div class="col s4 push-s4">
                  <div class="card">
                    <div class="card-content">
                      <span class="card-title"><h3>Change Password</h3></span>
                        <form class="container" action= "/account/changepass/" method="POST">
                        {% csrf_token %}
                          <div class = "row">
  
                            <div class="input-field col s12">
                              <input  name="email" id="email" type="email"  class="validate" required>
                              <label for="email">Email</label>
                            </div>
                            <div class="input-field col s12">
                                <input name="password" id="password" type="password" class="validate" required>
                                <label for="password">New Password</label>
                              </div>
                            <div class="input-field col s12">
                                <input name="confirm password" id="confirm password" type="password" class="validate" required>
                                <label for="confirm password">Confirm Password</label>
                              </div>
                            <div class="input-field col s12">
                              <button class="btn waves-effect waves-light" type="submit" name="action">
                                Submit
                              </button>
                            </div>
                          </div>
                        </form>
  
  
                    </div>
  
                  </div>
                </div>
              </div>
</div>
</body>
<script>
  $(document).ready(function(){
  $('form').on('submit', function() {

    var valid = true;
    var invalidStrings = ["--", "\"", "\'", "*", "where", "from", "?", "!", "=", ";"];
    
    $('form input').each(function() {
      // for csfr middlwware token
      if (this.type == "hidden")
        return true

      for(let i = 0; i < invalidStrings.length; i += 1)
      {
        if (this.value.includes(invalidStrings[i]))
        {
          alert("Invalid input. Sql injection, i see. xD");
          valid = false;
          return false;
        }
      }
    });

    return valid;
  });
});

  $(document).ready(function(){
  $('select').formSelect();
});
      
</script>
{% endblock %}
